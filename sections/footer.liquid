{% liquid
  assign has_social_links = false
  assign has_localization = false
  assign has_blocks = false
  assign social_platforms = 'linkedin, facebook, pinterest, instagram, twitter, youtube' | split: ', '

  for platform in social_platforms
    assign setting = 'social_#_link' | replace: '#', platform

    if settings[setting] != blank
      assign has_social_links = true
    endif
  endfor

  if section.settings.enable_localization and localization.available_countries.size >= 2 or localization.available_languages.size >= 2
    assign has_localization = true
  endif

  unless section.blocks.size == 0
    assign has_blocks = true
  endunless

  echo 'site-footer.css' | asset_url | stylesheet_tag: preload: true
%}

<footer class="site-footer">
  {% if has_blocks or has_localization or has_social_links %}
    <div class="site-footer__main grid no-gutter">
      <div class="col xs12 l8">
        {% if has_blocks %}
          <disclosure-state default-desktop-state="open" single-open="mobile">
            <div class="site-footer__columns">
              {% for block in section.blocks limit: 4 %}
                <details class="site-footer-column disclosure-reset">
                  <summary class="site-footer-column__header">
                    <p class="text-subheading">{{ block.settings.heading }}</p>
                    {% render 'icon-direction', icon: 'arrow-down' %}
                  </summary>

                  {% unless block.settings.menu == blank or block.settings.menu.links.size == 0 %}
                    <ul class="site-footer-column__menu list-reset">
                      {% for menu_item in block.settings.menu.links %}
                        <li>{{ menu_item.title | link_to: menu_item.url }}</li>
                      {% endfor %}
                    </ul>
                  {% endunless %}
                </details>
              {% endfor %}
            </div>
          </disclosure-state>
        {% endif %}
      </div>

      {% if has_localization or has_social_links %}
        <div class="col xs12 l3 offset-l9 site-footer__right">
          {% if has_localization %}
            <div class="site-footer__localization">
              {% unless section.settings.localization_heading == blank %}
                <p class="site-footer__localization-heading text-subheading">
                  {{ section.settings.localization_heading }}
                </p>
              {% endunless %}

              <button
                class="site-footer__localization-button button-reset text-subheading text-body-desktop"
                data-toggle="localization"
              >
                {{ localization.country.name }} /
                {{ localization.country.currency.symbol | append: localization.country.currency.iso_code }}

                {% render 'icon-direction', icon: 'arrow-right' %}
              </button>
            </div>
          {% endif %}

          {% if has_social_links %}
            <ul class="site-footer__social icon-grid list-reset">
              {% for platform in social_platforms %}
                {% assign setting = 'social_#_link' | replace: '#', platform %}

                {% unless settings[setting] == blank %}
                  <li>
                    <a href="{{ settings[setting] }}" target="_blank">
                      {% render 'icon-social', icon: platform %}
                    </a>
                  </li>
                {% endunless %}
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      {% endif %}
    </div>
  {% endif %}

  <div class="site-footer-base">
    <div class="site-footer-base__part">
      {% if section.settings.logo %}
        {{
          section.settings.logo
          | image_url: width: 200
          | image_tag: width: 100, loading: 'lazy'
          | link_to: routes.root_url
        }}
      {% endif %}

      <p class="text-subheading">
        &copy; {{ shop.name | link_to: routes.root_url }}
        {{ 'now' | date: '%Y' }}
      </p>
    </div>

    <div class="site-footer-base__part">
      {% render 'payment-logos' %}
    </div>
  </div>
</footer>

{% schema %}
{
  "name": "t:sections.footer.name",
  "class": "shopify-section-footer",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "t:sections.footer.settings.logo.label"
    },
    {
      "type": "header",
      "content": "t:sections.footer.settings.header__1.content"
    },
    {
      "type": "checkbox",
      "id": "enable_localization",
      "label": "t:sections.footer.settings.enable_localization.label",
      "default": false
    },
    {
      "type": "text",
      "id": "localization_heading",
      "label": "t:presets.settings.heading.label",
      "default": "Select your location"
    }
  ],
  "blocks": [
    {
      "type": "column",
      "name": "t:sections.footer.blocks.column.name",
      "limit": 4,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "t:presets.settings.heading.label",
          "default": "Column heading"
        },
        {
          "type": "link_list",
          "id": "menu",
          "label": "t:presets.settings.menu.label",
          "default": "footer"
        }
      ]
    }
  ]
}
{% endschema %}
