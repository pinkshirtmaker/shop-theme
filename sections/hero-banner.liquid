{% liquid
  assign has_content = false
  assign button_blocks = section.blocks | where: 'type', 'button'
  assign has_populated_button = false
  assign has_media = false

  unless section.settings.image == null and section.settings.video == null
    assign has_media = true
  endunless

  for button_block in button_blocks
    unless button_block.settings.label == empty or button_block.settings.url == null
      assign has_populated_button = true
    endunless
  endfor
%}

{% unless section.settings.subheading == empty
  and section.settings.heading == empty
  and section.settings.text == empty
  and has_populated_button == false
%}
  {% assign has_content = true %}
{% endunless %}

{{ 'hero-banner.css' | asset_url | stylesheet_tag }}

<div
  class="hero-banner {% if has_media %}hero-banner--media{% endif %}"
  style="
    {% unless section.settings.text_color == blank %}
      {% unless section.settings.text_color_invert == blank %}
      --color-invert: {{ section.settings.text_color_invert }};
      {% endunless %}
      --color: {{ section.settings.text_color }};
    {% endunless %}

    {% unless section.settings.background_color == '' %}
      background: {{ section.settings.background_color }};
    {% endunless %}

    --height: {{ section.settings.height }}px;
    --height-desktop: {{ section.settings.height_desktop }}px;
    --media-position: {{ section.settings.media_position }};
    --media-overlay-opacity: {{ section.settings.media_overlay_opacity | divided_by: 100.0 }};
  "
>
  {% unless section.settings.image == null and section.settings.video == null %}
    {% if section.settings.video %}
      {% render 'responsive-video',
        video: section.settings.video,
        video_desktop: section.settings.video_desktop,
        attributes: 'autoplay playsinline muted loop class="hero-banner__background"'
      %}
    {% else %}
      <picture class="display-contents">
        {% if section.settings.image_desktop %}
          <source
            media="(min-width: 1024px)"
            srcset="
              {{ section.settings.image_desktop | image_url: width: 352 }} 352w,
              {{ section.settings.image_desktop | image_url: width: 832 }} 832w,
              {{ section.settings.image_desktop | image_url: width: 1200 }} 1200w,
              {{ section.settings.image_desktop | image_url: width: 1920 }} 1920w,
              {{ section.settings.image_desktop | image_url: width: 5760 }} 5760w
            "
          >
        {% endif %}

        <source
          srcset="
            {{ section.settings.image | image_url: width: 352 }} 352w,
            {{ section.settings.image | image_url: width: 832 }} 832w,
            {{ section.settings.image | image_url: width: 1200 }} 1200w,
            {{ section.settings.image | image_url: width: 1920 }} 1920w,
            {{ section.settings.image | image_url: width: 5760 }} 5760w
          "
        >

        <img
          class="hero-banner__background"
          alt="{{ section.settings.image.alt }}"
          src="{{ section.settings.image | image_url: width: 5760 }}"
          height="{{ section.settings.image.height }}"
          width="{{ section.settings.image.width }}"
        >
      </picture>
    {% endif %}
  {% endunless %}

  {% if has_content %}
    <div
      class="
        hero-banner__content
        hero-banner__content--{{ section.settings.content_position }}
        hero-banner__content--{{ section.settings.content_position_desktop }}-desktop
        hero-banner__content--align-{{ section.settings.text_alignment }}
        hero-banner__content--align-{{ section.settings.text_alignment_desktop }}-desktop
      "
    >
      {% unless section.settings.subheading == empty %}
        <p class="text-subheading">{{ section.settings.subheading }}</p>
      {% endunless %}

      {% unless section.settings.heading == empty %}
        <p class="text-h1 no-margin">{{ section.settings.heading }}</p>
      {% endunless %}

      {% unless section.settings.text == empty %}
        <div class="rte">{{ section.settings.text }}</div>
      {% endunless %}

      {% if has_populated_button %}
        <div class="hero-banner__buttons">
          {% for button_block in button_blocks %}
            {% unless button_block.settings.label == empty or button_block.settings.url == null %}
          {%- comment -%}
              Custom button styling: white background, black text (hardcoded)
              {%- endcomment -%}
            <a
  class="button button--small button--rounded"
  href="{{ button_block.settings.url }}"
  style="background-color: #FFFFFF; color: #000000; border: none;"
  {{ button_block.shopify_attributes }}
>
  {{- button_block.settings.label -}}
</a>
            {% endunless %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  {% endif %}
</div>

{% schema %}
{
  "name": "t:sections.hero-banner.name",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.hero-banner.settings.header__1.content"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "t:presets.settings.subheading.label",
      "default": "Subheading text"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:presets.settings.heading.label",
      "default": "Heading text"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "t:presets.settings.content.label"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "t:presets.settings.text_color.label"
    },
    {
      "type": "color",
      "id": "text_color_invert",
      "label": "t:presets.settings.text_color_invert.label",
      "info": "t:presets.settings.text_color_invert.info"
    },
    {
      "type": "color_background",
      "id": "background_color",
      "label": "t:presets.settings.background_color.label"
    },
    {
      "type": "select",
      "id": "content_position",
      "label": "t:sections.hero-banner.settings.content_position.label",
      "options": [
        {
          "value": "top-left",
          "label": "t:sections.hero-banner.settings.content_position.options.top-left.label"
        },
        {
          "value": "middle-left",
          "label": "t:sections.hero-banner.settings.content_position.options.middle-left.label"
        },
        {
          "value": "bottom-left",
          "label": "t:sections.hero-banner.settings.content_position.options.bottom-left.label"
        },
        {
          "value": "top-center",
          "label": "t:sections.hero-banner.settings.content_position.options.top-center.label"
        },
        {
          "value": "middle-center",
          "label": "t:sections.hero-banner.settings.content_position.options.middle-center.label"
        },
        {
          "value": "bottom-center",
          "label": "t:sections.hero-banner.settings.content_position.options.bottom-center.label"
        },
        {
          "value": "top-right",
          "label": "t:sections.hero-banner.settings.content_position.options.top-right.label"
        },
        {
          "value": "middle-right",
          "label": "t:sections.hero-banner.settings.content_position.options.middle-right.label"
        },
        {
          "value": "bottom-right",
          "label": "t:sections.hero-banner.settings.content_position.options.bottom-right.label"
        }
      ],
      "default": "bottom-left"
    },
    {
      "type": "text_alignment",
      "id": "text_alignment",
      "label": "t:sections.hero-banner.settings.text_alignment.label"
    },
    {
      "type": "select",
      "id": "content_position_desktop",
      "label": "t:sections.hero-banner.settings.content_position_desktop.label",
      "options": [
        {
          "value": "top-left",
          "label": "t:sections.hero-banner.settings.content_position.options.top-left.label"
        },
        {
          "value": "middle-left",
          "label": "t:sections.hero-banner.settings.content_position.options.middle-left.label"
        },
        {
          "value": "bottom-left",
          "label": "t:sections.hero-banner.settings.content_position.options.bottom-left.label"
        },
        {
          "value": "top-center",
          "label": "t:sections.hero-banner.settings.content_position.options.top-center.label"
        },
        {
          "value": "middle-center",
          "label": "t:sections.hero-banner.settings.content_position.options.middle-center.label"
        },
        {
          "value": "bottom-center",
          "label": "t:sections.hero-banner.settings.content_position.options.bottom-center.label"
        },
        {
          "value": "top-right",
          "label": "t:sections.hero-banner.settings.content_position.options.top-right.label"
        },
        {
          "value": "middle-right",
          "label": "t:sections.hero-banner.settings.content_position.options.middle-right.label"
        },
        {
          "value": "bottom-right",
          "label": "t:sections.hero-banner.settings.content_position.options.bottom-right.label"
        }
      ],
      "default": "bottom-left"
    },
    {
      "type": "text_alignment",
      "id": "text_alignment_desktop",
      "label": "t:sections.hero-banner.settings.text_alignment_desktop.label"
    },
    {
      "type": "header",
      "content": "t:sections.hero-banner.settings.header__2.content"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:presets.settings.image_mobile.label"
    },
    {
      "type": "image_picker",
      "id": "image_desktop",
      "label": "t:presets.settings.image_desktop.label"
    },
    {
      "type": "video",
      "id": "video",
      "label": "t:presets.settings.video_mobile.label"
    },
    {
      "type": "video",
      "id": "video_desktop",
      "label": "t:presets.settings.video_desktop.label"
    },
    {
      "type": "paragraph",
      "content": "t:presets.settings.video_paragraph.content"
    },
    {
      "type": "select",
      "id": "media_position",
      "label": "t:sections.hero-banner.settings.media_position.label",
      "options": [
        {
          "value": "top",
          "label": "t:presets.settings.vertical_position.options.top.label"
        },
        {
          "value": "center",
          "label": "t:presets.settings.vertical_position.options.middle.label"
        },
        {
          "value": "bottom",
          "label": "t:presets.settings.vertical_position.options.bottom.label"
        }
      ]
    },
    {
      "type": "range",
      "id": "media_overlay_opacity",
      "label": "t:presets.settings.overlay_opacity.label",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 15,
      "unit": "%"
    },
    {
      "type": "header",
      "content": "t:sections.hero-banner.settings.header__3.content"
    },
    {
      "type": "number",
      "id": "height",
      "label": "t:sections.hero-banner.settings.height.label",
      "info": "t:sections.hero-banner.settings.height.info",
      "default": 550
    },
    {
      "type": "number",
      "id": "height_desktop",
      "label": "t:sections.hero-banner.settings.height_desktop.label",
      "info": "t:sections.hero-banner.settings.height.info",
      "default": 678
    }
  ],
  "blocks": [
    {
      "type": "button",
      "name": "t:sections.hero-banner.blocks.button.name",
      "limit": 2,
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "t:presets.settings.button_label.label",
          "default": "Button label"
        },
        {
          "type": "url",
          "id": "url",
          "label": "t:presets.settings.button_url.label",
          "default": "/collections/all"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.hero-banner.name",
      "blocks": [
        {
          "type": "button"
        }
      ]
    }
  ]
}
{% endschema %}
